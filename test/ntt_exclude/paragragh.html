


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<script src="https://shutto-translation-development-kawate.s3.amazonaws.com/trans.js?id=1583"></script>
    <script type="text/javascript" src="http://www.intra-mart.jpc747.systranlinks.net/sl_language_selector.js"></script>
    <title>4.3. エレメントのサンプル実装 &mdash; IM-BloomMaker プログラミングガイド &nbsp; 第3版 2020-04-01 &nbsp; intra-mart Accel Platform</title>
    

    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '第3版 2020-04-01',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <link rel="top" title="intra-mart Accel Platform" href="../../index.html" />
    <link rel="up" title="4. エレメント・アクションアイテムの作成" href="index.html" />
    <link rel="next" title="4.4. アクションアイテムを実装する" href="action_item_implementation.html" />
    <link rel="prev" title="4.2. エレメントを実装する" href="element_implementation.html" />

    <!--[if IE 8]>
      <link rel="stylesheet" href="../../_static/ie8.css" type="text/css" />
    <![endif]-->
    <!--[if lte IE 9.0]>
      <script type="text/javascript">
        window.disableQuickSearch = true;
      </script>
      <link rel="stylesheet" href="../../_static/ie9.css" type="text/css" />
    <![endif]-->

  </head>
  <body>
<div class="container">
  <div class="header">
    <div class="heading">
      <p class="left">
        <a href="http://www.intra-mart.jp/document/library/index.html" title="intra-mart Accel Series Document Library">
          <span class="header-logo"></span>
        </a>
        <span class="name-split" style="display:none;">&nbsp;|&nbsp;</span>
      </p>
      <p class="right">
        <a href="../../index.html" class="document-name">
          <span class="product-name">intra-mart Accel Platform</span>
          IM-BloomMaker プログラミングガイド
        </a>
        <span class="heading-supplementation">第3版 2020-04-01</span>
      </p>
    </div>

    <div class="quicksearch">
<div id="searchbox">
    <form class="oktavia_form">
      <label>クイック検索</label>
      <input class="oktavia_search" result="10" type="search" name="search" value="" placeholder="クイック検索" />
      <input type="submit" value="検索" />
    </form>
  </div>
</div>
<!--
<div id="searchbox" class="hoge" style="display: none">
  <label>クイック検索</label>
  <form class="search" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="クイック検索" />
    <input type="submit" value="検索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
-->
    </div>
  </div>

  <div class="pdf-header">
    <div class="left"><span class="header-logo"></span></div>
    <div class="right">
      <span class="product-name">intra-mart Accel Platform</span>
      <span class="shorttitle">IM-BloomMaker プログラミングガイド</span>
      <span class="heading-supplementation">第3版 2020-04-01</span>
    </div>
  </div>

  <div class="nav topnav">
    
  <p class="cf">
    <a class="uplink" href="../../index.html">目次</a>
    <a class="prev-link" href="element_implementation.html"><span class="mark">&#8810;&#160;&#160;</span><span class="index-title">4.2. エレメントを実装する</span></a>
    <a class="next-link" href="action_item_implementation.html"><span class="index-title">4.4. アクションアイテムを実装する</span><span class="mark">&#160;&#160;&#8811;</span></a>
  </p>

  </div>

  <div class="wrapper">
      <div id="sidebar-left" class="sidebar active">
        
    <div class="sphinxsidebar">
      <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../revision_history/index.html">1. 改訂情報</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">2. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocessor/index.html">3. 前処理プログラム</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. エレメント・アクションアイテムの作成</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">4.1. エレメント・アクションアイテムを作成する</a></li>
<li class="toctree-l2"><a class="reference internal" href="element_implementation.html">4.2. エレメントを実装する</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">4.3. エレメントのサンプル実装</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.3.1. 本体のクラスを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.3.2. 制約を実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">4.3.3. 表示形式を実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#link-implement-unique-property-sample">4.3.4. 固有プロパティを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#createelement">4.3.5. createElement メソッドを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updateelement">4.3.6. updateElement メソッドを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">4.3.7. 実装したクラスの登録</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">4.3.8. プロパティファイルの実装</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="action_item_implementation.html">4.4. アクションアイテムを実装する</a></li>
</ul>
</li>
</ul>

      </div>
    </div>
      </div>
      <div class="content">
        
<blockquote>
<div></div></blockquote>
<div class="section" id="link-element-sample">
<span id="id1"></span><h1>4.3. エレメントのサンプル実装<a class="headerlink" href="#link-element-sample" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>この章では、添付のサンプル（sample.zip の implemented ディレクトリ）の郵便番号入力エレメント（MyZipCodeField.ts）の実装について、説明します。</p>
<p>郵便番号入力エレメントは、以下のようなエレメントです。</p>
<ul class="simple">
<li>全体の親要素(<cite>&lt;div&gt;</cite>)と、その子要素である2つのテキストボックス(<cite>&lt;input&gt;</cite>)と1つのラベル(<cite>&lt;label&gt;</cite>)から構成されています。</li>
<li>1つめのテキストボックスに3桁、2つめのテキストボックスに4桁まで値を入力できます。</li>
<li>全体でvalueという固有プロパティを持っています。valueの値は、2つのテキストボックスに入力された値を連結したものです。既存の多くのコンポーネントと同様に、双方向バインディングで実装します。（双方向バインディングについては、 <a class="reference internal" href="element_implementation.html#link-add-unique-property"><em>固有プロパティを追加する</em></a> を参照してください。）</li>
</ul>
<p><img alt="sample_element_1" src="../../_images/element_sample_1.png" style="width: 49%;" /> <img alt="sample_element_2" src="../../_images/element_sample_2.png" style="width: 49%;" /></p>
<div class="section" id="id2">
<h2>4.3.1. 本体のクラスを実装する<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>まずは、 <tt class="docutils literal"><span class="pre">{VSCODE_HOME}/src/public/elements</span></tt> に、MyZipCodeField.ts を作成します。</p>
<p>MyZipCodeField クラスで IUIElementCore インタフェースを実装します。 <tt class="docutils literal"><span class="pre">//</span> <span class="pre">TODO</span></tt> の部分はこれから実装していきます。</p>
<div class="highlight-ts"><div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">MyZipCodeField</span> <span class="kr">implements</span> <span class="nx">IUIElementCore</span> <span class="p">{</span>

    <span class="c1">// 繰り返しのないエレメントなので、SimpleUIElement を指定します。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">wrapperClass</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIElementWrapperClass</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;SimpleUIElement&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメント名を返却するメソッドです。</span>
    <span class="c1">// { エレメントのクラス名 } .name 形式で、エレメントのクラス名を返却します。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">elementTypeName</span><span class="p">()</span><span class="o">:</span> <span class="kt">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">MyZipCodeField</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメントの表示形式を返却するメソッドです。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">displayType</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIElementDisplayType</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// TODO</span>
</span>    <span class="p">}</span>

    <span class="c1">// エレメントの配置制約を定義したファイルのクラス名を返却します。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">constraintClass</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIComponentConstraintClass</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// TODO</span>
</span>    <span class="p">}</span>

    <span class="c1">// エレメント固有プロパティの定義を返却します。</span>
    <span class="c1">// 固有プロパティがない場合は、空のオブジェクトを返却します。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">uniquePropertyDefinition</span><span class="p">()</span><span class="o">:</span> <span class="nx">IUniquePropertyDefinition</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// TODO</span>
</span>    <span class="p">}</span>

    <span class="c1">// 共通プロパティの定義を返却します。</span>
    <span class="c1">// 固有プロパティがない場合は、空のオブジェクトを返却します。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">commonPropertyDefinition</span><span class="p">()</span><span class="o">:</span> <span class="nx">ICommonPropertyDefinition</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="c1">// 依存させたいエレメントのクラスを返却します。</span>
    <span class="c1">// ここで指定されたエレメントは、当該エレメントとの間に依存関係が定義され、自動的に定義が読み込まれます。</span>
    <span class="c1">// 子エレメントを実装する必要がない場合は、空の配列を返却します。</span>
    <span class="c1">// 返却値は子エレメントのクラス名です。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">dependElements</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIElementCoreClass</span><span class="p">[]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>

    <span class="c1">// エレメント作成時に一度だけ呼び出されるメソッドです。</span>
    <span class="c1">// このメソッド内でエレメントのビルダーを作成して返却します。</span>
    <span class="c1">// このサンプルでは、&lt;div&gt;タグやその子要素の&lt;input&gt;タグを作成する処理を記述していきます。</span>
    <span class="kr">public</span> <span class="nx">createElement</span><span class="p">(</span>
        <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">,</span>
        <span class="nx">properties</span>: <span class="kt">IUIElementPropertyAccessor</span><span class="o">&lt;</span><span class="nx">PropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">ICommonPropertyDefinition</span><span class="o">&gt;</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">IHTMLElementBuilder</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// TODO</span>
</span>    <span class="p">}</span>

    <span class="c1">// レンダリングが必要になった際に呼び出されるメソッドです。</span>
    <span class="c1">// 例えば、rerender: trueのプロパティの値が変更されたときなど、エレメント側を更新する必要がある場合にその処理を記述します。</span>
    <span class="c1">// このサンプルでは、プロパティであるvalueが変更された際に、子要素の&lt;input&gt;タグにvalueの値を反映させる処理を記述していきます。</span>
    <span class="kr">public</span> <span class="nx">updateElement</span><span class="p">(</span>
        <span class="nx">builder</span>: <span class="kt">IHTMLElementBuilder</span><span class="p">,</span>
        <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">,</span>
        <span class="nx">properties</span>: <span class="kt">IUIElementPropertyAccessor</span><span class="o">&lt;</span><span class="nx">PropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">ICommonPropertyDefinition</span><span class="o">&gt;</span>
    <span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// TODO</span>
</span>    <span class="p">}</span>

    <span class="c1">// デザイナ上でエレメントが削除された際などに呼び出されるメソッドです。</span>
    <span class="c1">// 基本的には特に何の処理も記述しません。</span>
    <span class="kr">public</span> <span class="nx">destroyElement</span><span class="p">(</span>
        <span class="nx">builder</span>: <span class="kt">IHTMLElementBuilder</span><span class="p">,</span>
        <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">,</span>
        <span class="nx">properties</span>: <span class="kt">IUIElementPropertyAccessor</span><span class="o">&lt;</span><span class="nx">IUniquePropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">ICommonPropertyDefinition</span><span class="o">&gt;</span>
    <span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// このメソッドでエレメントに子要素を追加できます。</span>
    <span class="c1">// このエレメントが作成された際に自動的に用意する子エレメントのインスタンスを返却してください。</span>
    <span class="c1">// 子エレメントは配列の格納順に配置されます。</span>
    <span class="c1">// 子要素がない場合は空の配列を返却します。</span>
    <span class="c1">// appendChild() で子要素を追加する場合と異なり、デザイナ上でコンテナに配置した際に、子要素はそれぞれ別のエレメントとして扱われます。</span>
    <span class="kr">public</span> <span class="nx">createChildren</span><span class="p">(</span><span class="nx">self</span>: <span class="kt">IUIElement</span><span class="p">,</span> <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">)</span><span class="o">:</span> <span class="nx">IUIElement</span><span class="p">[]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>

    <span class="c1">// レンダリングが必要になった際に、都度呼び出されるメソッドです。</span>
    <span class="c1">// 引数で渡された子エレメントの配列を変更する必要がある場合、変更後の配列を返却してください。</span>
    <span class="c1">// 変更の必要がない場合は、引数の children をそのまま返却してください。</span>
    <span class="kr">public</span> <span class="nx">updateChildren</span><span class="p">(</span>
        <span class="nx">children</span>: <span class="kt">IUIElement</span><span class="p">[],</span>
        <span class="nx">self</span>: <span class="kt">IUIElement</span><span class="p">,</span>
        <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">,</span>
        <span class="nx">properties</span>: <span class="kt">IUIElementPropertyAccessor</span><span class="o">&lt;</span><span class="nx">IUniquePropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">ICommonPropertyDefinition</span><span class="o">&gt;</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">IUIElement</span><span class="p">[]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">children</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 仮想エレメントがクローンによって作成された際に呼び出されるメソッドです。</span>
    <span class="c1">// エレメントが複製されたタイミングで特殊な採番処理等を行いたい場合などに、その処理を記述します。</span>
    <span class="c1">// 引数で渡された子エレメントの配列を変更する必要がある場合、変更後の配列を返却してください。</span>
    <span class="c1">// 変更の必要がない場合は、引数の children をそのまま返却してください。</span>
    <span class="c1">// 基本的には変更の必要はありません。</span>
    <span class="kr">public</span> <span class="nx">clonedChildren</span><span class="p">(</span>
        <span class="nx">children</span>: <span class="kt">IUIElement</span><span class="p">[],</span>
        <span class="nx">self</span>: <span class="kt">IUIElement</span><span class="p">,</span>
        <span class="nx">container</span>: <span class="kt">IUIContainer</span><span class="p">,</span>
        <span class="nx">properties</span>: <span class="kt">IUIElementPropertyAccessor</span><span class="o">&lt;</span><span class="nx">IUniquePropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">ICommonPropertyDefinition</span><span class="o">&gt;</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">IUIElement</span><span class="p">[]</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">children</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


<div class="section" id="id3">
<h2>4.3.2. 制約を実装する<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>制約クラス Constraint で IUIComponentConstraint を実装します。</p>
<p>ここでは、以下のように制約を定義します。</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>制約の内容</strong></td>
<td><strong>可否</strong></td>
<td><strong>対応するメソッド</strong></td>
</tr>
<tr class="row-even"><td>エレメントの移動</td>
<td>可能</td>
<td>movable()</td>
</tr>
<tr class="row-odd"><td>エレメントの削除</td>
<td>可能</td>
<td>removable()</td>
</tr>
<tr class="row-even"><td>エレメントの複製</td>
<td>可能</td>
<td>copyable()</td>
</tr>
<tr class="row-odd"><td>子エレメントの配置</td>
<td>不可能</td>
<td><div class="first last line-block">
<div class="line">extremity()</div>
<div class="line">acceptableChild()</div>
</div>
</td>
</tr>
<tr class="row-even"><td>親エレメントの配置</td>
<td>可能</td>
<td>acceptableParent()</td>
</tr>
</tbody>
</table>
<p>この場合の実装は以下です。</p>
<div class="highlight-ts"><div class="highlight"><pre><span class="kr">class</span> <span class="nx">Constraint</span> <span class="kr">implements</span> <span class="nx">IUIComponentConstraint</span> <span class="p">{</span>

    <span class="c1">// エレメントの移動可否を指定するメソッドです。</span>
    <span class="c1">// true か false を返却値に指定します。true を返却する場合、デザイナ画面上に配置したエレメントを移動できます。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">movable</span><span class="p">()</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメントの削除可否を指定するメソッドです。</span>
    <span class="c1">// true か false を返却値に指定します。true を返却する場合、デザイナ画面上に配置したエレメントを削除できます。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">removable</span><span class="p">()</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメントの複製可否を指定するメソッドです。</span>
    <span class="c1">// true か false を返却値に指定します。true を返却する場合、デザイナ画面上に配置したエレメントを複製できます。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">copyable</span><span class="p">()</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメントが末端かどうか（配下への子エレメントの配置可否）を指定するメソッドです。</span>
    <span class="c1">// true か false を指定します。</span>
    <span class="c1">// true を返却する場合、デザイナ画面上に配置したエレメントの配下に子エレメントは配置できません。</span>
    <span class="c1">// このメソッドの返却値を true に指定した場合は acceptableChild() の返却値を false 、逆に false を指定した場合は acceptableChild() の返却値を true に指定するようにしてください。</span>
    <span class="kr">public</span> <span class="nx">get</span> <span class="nx">extremity</span><span class="p">()</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// エレメントにおける親エレメントの配置可否を指定するメソッドです。</span>
    <span class="c1">// true か false を指定します。true を返却した場合、デザイナ画面上に配置したエレメントに親エレメントを配置できます。</span>
    <span class="kr">public</span> <span class="nx">acceptableParent</span><span class="p">(</span><span class="nx">parent</span>: <span class="kt">ParentUIElement</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 子エレメントの配置可否を指定するメソッドです。</span>
    <span class="c1">// true か false を指定します。true を返却した場合、デザイナ画面上に配置したエレメントに対し子エレメントを配置できます。</span>
    <span class="c1">// このメソッドの返却値を true に指定した場合には extremity() の返却値を false 、逆に false を指定した場合には extremity() の返却値を true に指定するようにしてください。</span>
    <span class="kr">public</span> <span class="nx">acceptableChild</span><span class="p">(</span><span class="nx">child</span>: <span class="kt">IUIElement</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>MyZipCodeField クラスの constraintClass メソッドで、制約クラスを返却します。</p>
<div class="highlight-ts"><div class="highlight"><pre><span class="c1">// 上で実装した制約クラスのクラス名 Constraint を返却します。</span>
<span class="kr">public</span> <span class="nx">get</span> <span class="nx">constraintClass</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIComponentConstraintClass</span> <span class="p">{</span>
    <span class="k">return</span>  <span class="nx">Constraint</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>4.3.3. 表示形式を実装する<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">表示形式は INPUT を選択します。</div>
<div class="line">MyZipCodeField クラスの displayType メソッドで、INPUT という文字列を返却します。</div>
</div>
<div class="highlight-ts"><div class="highlight"><pre><span class="c1">// エレメントの表示形式を返却します。</span>
<span class="kr">public</span> <span class="nx">get</span> <span class="nx">displayType</span><span class="p">()</span><span class="o">:</span> <span class="nx">UIElementDisplayType</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>返却可能な文字列については、<a class="reference internal" href="element_implementation.html#link-implement-display-type"><em>エレメントの表示形式を実装する</em></a> を参照してください。</p>
</div>
<div class="section" id="link-implement-unique-property-sample">
<span id="id5"></span><h2>4.3.4. 固有プロパティを実装する<a class="headerlink" href="#link-implement-unique-property-sample" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">固有プロパティ value を実装します。</div>
<div class="line">PropertyDefinition タイプを宣言し、value プロパティの型を UniquePropertyDefinitionType として宣言します。</div>
<div class="line">続いて、それを継承した uniquePropertyDefinition という変数を宣言し、その中で value プロパティの定義を記述します。</div>
</div>
<div class="highlight-ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">PropertyDefinition</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">value</span>: <span class="kt">UniquePropertyDefinitionType</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// エレメント固有カテゴリのプロパティは uniquePropertyDefinition で設定できます。</span>
<span class="kr">const</span> <span class="nx">uniquePropertyDefinition</span>: <span class="kt">IUniquePropertyDefinition</span> <span class="o">&amp;</span> <span class="nx">PropertyDefinition</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">displayName</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="nx">definition</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">required</span>: <span class="kt">true</span><span class="p">,</span>
        <span class="c1">// valueプロパティの値が変わった時に再レンダリングされる必要がある</span>
        <span class="nx">rerender</span>: <span class="kt">true</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
<p>MyZipCodeField クラスの uniquePropertyDefinition メソッドで、value プロパティを定義した変数 uniquePropertyDefinition を返却します。</p>
<div class="highlight-ts"><div class="highlight"><pre><span class="kr">public</span> <span class="nx">get</span> <span class="nx">uniquePropertyDefinition</span><span class="p">()</span><span class="o">:</span> <span class="nx">IUniquePropertyDefinition</span> <span class="p">{</span>
<span class="hll">    <span class="k">return</span> <span class="nx">uniquePropertyDefinition</span><span class="p">;</span>
</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="createelement">



      </div>
      <div id="sidebar-right" class="sidebar">
        
        
    <div class="sphinxsidebar">
      <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../revision_history/index.html">1. 改訂情報</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">2. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocessor/index.html">3. 前処理プログラム</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. エレメント・アクションアイテムの作成</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">4.1. エレメント・アクションアイテムを作成する</a></li>
<li class="toctree-l2"><a class="reference internal" href="element_implementation.html">4.2. エレメントを実装する</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">4.3. エレメントのサンプル実装</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.3.1. 本体のクラスを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.3.2. 制約を実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">4.3.3. 表示形式を実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#link-implement-unique-property-sample">4.3.4. 固有プロパティを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#createelement">4.3.5. createElement メソッドを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updateelement">4.3.6. updateElement メソッドを実装する</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">4.3.7. 実装したクラスの登録</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">4.3.8. プロパティファイルの実装</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="action_item_implementation.html">4.4. アクションアイテムを実装する</a></li>
</ul>
</li>
</ul>

      </div>
    </div>
      </div>
  </div>

  <div class="nav bottomnav">
    
  <p class="cf">
    <a class="uplink" href="../../index.html">目次</a>
    <a class="prev-link" href="element_implementation.html"><span class="mark">&#8810;&#160;&#160;</span><span class="index-title">4.2. エレメントを実装する</span></a>
    <a class="next-link" href="action_item_implementation.html"><span class="index-title">4.4. アクションアイテムを実装する</span><span class="mark">&#160;&#160;&#8811;</span></a>
  </p>

  </div>

  <div class="footer">
    <hr class="bar" />
    <div class="inner">
      <p class="copyright">
           Copyright &copy; 2019 NTT DATA INTRAMART CORPORATION 
      </p>
      <a id="disp-sidebar-switch-btn" class="sidebar-button" title="Switch sidebar position"><span class="mark"></span><span class="text">&#x21C4; Sidebar</span></a>
      <a class="page-top" href="#" title="Go to page top"><span class="mark">&uarr;</span><span class="text">Top</span></a>
    </div>
  </div>
</div>

<script>
  (function($) {
    $(document).ready(function() {
      // shutto翻訳画像切り替え処理
      if (__stt) {
        // Polyfill for ie
        if (!String.prototype.endsWith) {
          String.prototype.endsWith = function(search, this_len) {
            if (this_len === undefined || this_len > this.length) {
              this_len = this.length;
            }
            return this.substring(this_len - search.length, this_len) === search;
          };
        }
        // shuttoのセルフ翻訳画像が優先されないように初期表示時の画像のsrc属性をキャッシュする
        var imgSrcCache = []
        var getImgSrcCache = function(img) {
          for (let i = 0; imgSrcCache.length > i; i++) {
            // alt属性はshuttoのセルフ翻訳が入っていても不変
            if (imgSrcCache[i] === $(img).attr("alt")) return imgSrcCache[i]
          }
          return null
        }
        // 多言語画像が存在する場合のみ置換を行う
        var replaceImg = function(url, $target) {
          $.ajax({
            url: url,
            type: 'HEAD',
            success: function() {
              $target.attr("src", url);
              // 画像をクリックした際に表示される画像も置換する
              if (!!$target.parent().attr("href")) $target.parent().attr("href", url);
            }
          });
        }
        var getFileName = function(str) {
          return str.slice(0, str.lastIndexOf("."));
        }
        var getExt = function(str) {
          return str.slice(str.lastIndexOf("."));
        }
        var trimFileName = function(fileName) {
          if (fileName.endsWith('_en')) return fileName.slice(0, -3);
          if (fileName.endsWith('_zh_CN')) return fileName.slice(0, -6);
          return fileName
        }
        var needSwitchImg = function($target) {
            let src = $target.attr("src")
            // src属性がない場合は対象外
            if (!src) return false
            // src属性とalt属性が一致しない場合（アイコン画像など）は対象外
            if (trimFileName(getFileName(src)) !== getFileName($target.attr("alt"))) return false
            return true
        }
        var switchImgOnInit = function(lang) {
          if (lang === 'zh-CN') lang = 'zh_CN'
          $("img").each(function() {
            let oldSrc = $(this).attr("src");
            if (!needSwitchImg($(this))) return;

            let cache = getImgSrcCache(this)
            if (cache === null) {
              imgSrcCache.push($(this).attr("alt"))
            } else {
              oldSrc = cache
            }

            if (lang === 'ja') return;

            let fileName = getFileName(oldSrc)
            let ext = getExt(oldSrc)
            let newSrc = `${fileName}_${lang}${ext}`
            replaceImg(newSrc, $(this))
          });
        }
        var switchImgOnChange = function(lang) {
          $("img").each(function() {
            let oldSrc = $(this).attr("src");
            if (!needSwitchImg($(this))) return;

            let cache = getImgSrcCache(this)
            if (cache === null) {
              imgSrcCache.push($(this).attr("alt"))
            } else {
              oldSrc = cache
            }

            let fileName = getFileName(oldSrc);
            let ext = getExt(oldSrc);
            switch (lang) {
              case 'ja': {
                fileName = trimFileName(fileName)
                let newSrc = `${fileName}${ext}`
                $(this).attr("src", newSrc);
                if (!!$(this).parent().attr("href")) $(this).parent().attr("href", newSrc);
                break;
              }
              case 'en': {
                fileName = trimFileName(fileName)
                let newSrc = `${fileName}_${lang}${ext}`
                replaceImg(newSrc, $(this))
                break;
              }
              case 'zh-CN': {
                fileName = trimFileName(fileName)
                let newSrc = `${fileName}_zh_CN${ext}`
                replaceImg(newSrc, $(this))
                break;
              }
              default:
                return;
            }
          });
        }
        __stt.get('lang', function(lang) {
          switchImgOnInit(lang)
          // shutto側のセルフ翻訳画像が存在する場合を考慮して、描画後に再度置換処理を行う
          if (!!window.setTimeout) window.setTimeout(switchImgOnInit, 1000, lang);
        });
        __stt.on('selectLang', function(event) {
          switchImgOnChange(event.lang)
          // shutto側のセルフ翻訳画像が存在する場合を考慮して、描画後に再度置換処理を行う
          if (!!window.setTimeout) window.setTimeout(switchImgOnChange, 1000, event.lang);
        });
      }

      var setPosition = function(position) {
        if (position === 'left') {
          $.cookie('im-document-library', 'left', {expires: 30, path: '/'});
        } else {
          $.cookie('im-document-library', 'right', {expires: 30, path: '/'});
        }
      }

      if ($.cookie('im-document-library') == 'right') {
        $("#sidebar-right").addClass('active');
        $("#sidebar-left").removeClass('active');
      }

      $("#disp-sidebar-switch-btn").click(function() {
        $("#sidebar-right").toggleClass('active');
        $("#sidebar-left").toggleClass('active');
        if ($('#sidebar-left').hasClass('active')) {
          setPosition('left');
        } else {
          setPosition('right');
        }
      });
      // ページ内遷移のときに、スクロールの位置がヘッダー分ずれる不具合の対応
      $('a').click(function(e){
        var _href = $(this).attr('href');
        if (_href != null) {
          if (_href.length > 2) {
            if (_href.indexOf('#') == 0) {
              setTimeout(function() {
                var $id = $(_href.replace( /(:|\.|\[|\]|\(|\))|,/g, "\\$1" ));
                $(document).scrollTop($id.position().top);
              },1);
            }
          }
        }
      })
      // 異なるページからアンカーを指定された場合、スクロールの位置がヘッダー分ずれる不具合の対応
      if (window.location.hash.length > 0) {
        setTimeout(function(){
          var $id = $(decodeURIComponent(window.location.hash).replace( /(:|\.|\[|\]|\(|\))|,/g, "\\$1" ));
          if ($id.length > 0) {
            $(document).scrollTop($id.position().top);
          }
        },50);
      }
    });
  })(jQuery);
</script>
<script>
    $('a.reference.external').click(function(){
        window.open($(this).attr('href'));
        return false;
     });
</script>

  </body>
</html>
